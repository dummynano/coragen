var querystringValues,lattitudeValue,longitudeValue,gv_callbackURL,gv_processId,showModal=!1,isNameMandatory=!1,isLocationMandatory=!1,baseURL="https://cloud.neoint.ai/FMC/codeverificationapi/",token="Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6ImEzck1VZ01Gdjl0UGNsTGE2eUY",attributeNames={URL:"http://fmcagri.com/qrdata/",MPin:"ID",BatchNumber:"BT",MfgDate:"MD",ExpDate:"ED",PackSize:"SZ",ProductName:"PR"},errorMessages={InvalidName:"Please enter valid name",InvalidMobile:"Please enter valid mobile number",EmptyName:"Please enter name",EmptyMobile:"Please enter mobile number",LogApiError500:"Error while logging the details, please try again.",GetHTMLApiError500:"Could not get code details, please try again.",GetProcessIDApiError500:"Error in getting process id, please try again.",LocationDisabled:"Please enable the location and reload the page",BrowserDoesnotSupportGeoLocation:"Browser doesn't support geolocation"};function onPageLoad(){querystringValues=getUrlValues(),getProcessID()}function getProcessID(){var e={Url:attributeNames.URL,MPin:querystringValues[attributeNames.MPin],BatchNumber:querystringValues[attributeNames.BatchNumber],MfgDate:querystringValues[attributeNames.MfgDate],ExpDate:querystringValues[attributeNames.ExpDate],MaterialCode:querystringValues[attributeNames.MaterialCode],ProductName:querystringValues[attributeNames.ProductName],PackSize:querystringValues[attributeNames.PackSize],PackageType:querystringValues.p};$.ajax({url:baseURL+"api/CodeVerification/Process",type:"POST",data:e,headers:{Authorization:token},dataType:"json",success:function(e){bindHTML(e)},error:function(e){$("#result").html(errorMessages.GetProcessIDApiError500)}})}function logVisiterDetails(){if(isLocationMandatory&&!lattitudeValue){alert(errorMessages.LocationDisabled);return}if(isNameMandatory&&!$("#txtName").val()){alert(errorMessages.EmptyName);return}if(!nameValidation()){alert(errorMessages.InvalidName);return}if(!$("#txtMobile").val()){alert(errorMessages.EmptyMobile);return}if(!mobileValidation()){alert(errorMessages.InvalidMobile);return}var e={Url:attributeNames.URL,MPin:querystringValues[attributeNames.MPin],BatchNumber:querystringValues[attributeNames.BatchNumber],MfgDate:querystringValues[attributeNames.MfgDate],ExpDate:querystringValues[attributeNames.ExpDate],MaterialCode:querystringValues[attributeNames.MaterialCode],ProductName:querystringValues[attributeNames.ProductName],PackSize:querystringValues[attributeNames.PackSize],ProcessId:gv_processId,CreatedBy:$("#txtName").val(),MobileNumber:$("#txtMobile").val(),Location:$("#txtAddress").val()};showModal&&isLocationMandatory&&(e.Latitude=lattitudeValue,e.Longitude=longitudeValue),$.ajax({url:baseURL+"api/CodeVerification/Log",type:"post",data:e,headers:{Authorization:token},dataType:"json",success:function(e){e.IsSuccess?getHTML(gv_callbackURL):alert(e.ErrorDetail),document.getElementById("btnClose").click()},error:function(e){alert(errorMessages.LogApiError500)}})}function getHTML(e){$.ajax({url:baseURL+e,type:"GET",headers:{Authorization:token},dataType:"json",success:function(e){e?($("#result").html(e),hideDivs()):$("#result").html('<div class="container-fluid"><div class="headerText" style="text-align: center;"><h5>Could not get response from server. Please try again.</h5></div></div>')},error:function(e){alert(errorMessages.GetHTMLApiError500)}})}function hideDivs(){$("#spanCoMarketing").html()&&($(".Links").hide(),$(".FerterraText").hide(),$(".about-fmc").hide(),$(".line").hide())}function bindHTML(e){gv_callbackURL=e.CallBackUrl,gv_processId=e.ProcessId,showModal?(document.getElementById("btnModal").click(),isLocationMandatory&&(navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){lattitudeValue=e.coords.latitude,longitudeValue=e.coords.longitude},function(e){alert(errorMessages.LocationDisabled)}):alert(errorMessages.BrowserDoesnotSupportGeoLocation))):setTimeout(function(){getHTML(e.CallBackUrl)},500)}function getUrlValues(){for(var e,t=window.location.href,a={},r=t.slice(t.indexOf("?")+1).split("_"),i=0;i<r.length;i++)a[(e=r[i].split(":"))[0]]=e[1];return a}function mobileValidation(){var e;return $("#txtMobile").val().match(/^\d{10}$/)?($("#spnMobileError").html(""),!0):($("#spnMobileError").html(errorMessages.InvalidMobile),!1)}function nameValidation(){var e;return $("#txtName").val().match(/^[a-zA-Z][a-zA-Z\s]*$/)?($("#spnNameError").html(""),!0):($("#spnNameError").html(errorMessages.InvalidName),!1)}$(function(){onPageLoad()});